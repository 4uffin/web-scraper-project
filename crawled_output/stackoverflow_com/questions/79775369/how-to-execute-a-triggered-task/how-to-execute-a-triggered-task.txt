sql - How to EXECUTE a Triggered Task - Stack Overflow
Skip to main content
Stack Overflow
About
Products
For Teams
Stack Overflow for Teams
Where developers & technologists share private knowledge with coworkers
Advertising
Reach devs & technologists worldwide about your product, service or employer brand
Knowledge Solutions
Data licensing offering for businesses to build and improve AI tools and models
Labs
The future of collective knowledge sharing
About the company
Visit the blog
Loading…
current community
Stack Overflow
help
chat
Meta Stack Overflow
your communities
Sign up or log in to customize your list.
more stack exchange communities
company blog
Log in
Sign up
Home
Questions
AI Assist
Labs
Tags
Challenges
Chat
Articles
Users
Jobs
Companies
Collectives
Communities for your favorite technologies.
Explore all Collectives
Teams
Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
Try Teams for free
Explore Teams
Teams
Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
Explore Teams
Collectives™ on Stack Overflow
Find centralized, trusted content and collaborate around the technologies you use most.
Learn more about Collectives
Teams
Q&A for work
Connect and share knowledge within a single location that is structured and easy to search.
Learn more about Teams
How to EXECUTE a Triggered Task
Ask Question
Asked
today
Modified
today
Viewed
38 times
0
I have not been able to EXECUTE a Snowflake Triggered Task and I would like to better understand why, and where the behavior is documented.
To demonstrate my problem:
-- SETUP
USE SCHEMA EXAMPLE_DB.EXAMPLE_SCHEMA;
CREATE OR REPLACE TABLE TRIGGER_TABLE (TRIGGER_COL TIMESTAMP);
CREATE OR REPLACE STREAM TRIGGER_STREAM ON TABLE TRIGGER_TABLE;
CREATE OR REPLACE TABLE DESTINATION_TABLE (EXAMPLE_COL VARCHAR, INSERT_TIME TIMESTAMP);
CREATE OR REPLACE TASK TRIGGERED_TASK
WAREHOUSE = EXAMPLE_WAREHOUSE
WHEN SYSTEM$STREAM_HAS_DATA('TRIGGER_STREAM')
AS
INSERT INTO DESTINATION_TABLE (EXAMPLE_COL, INSERT_TIME)
VALUES ('TRIGGERED_TASK has run', CURRENT_TIMESTAMP());
ALTER TASK TRIGGERED_TASK RESUME;
-- Trigger the task
INSERT INTO TRIGGER_TABLE (TRIGGER_COL) VALUES (CURRENT_TIMESTAMP());
SELECT * FROM DESTINATION_TABLE;
-- Works great!
-- EXAMPLE_COL
|INSERT_TIME
|
-- ----------------------+-----------------------+
-- TRIGGERED_TASK has run|2025-09-25 15:25:33.638|
-- Execute the task
EXECUTE TRIGGERED_TASK;
-- Output: SQL Error [603] [XX000]: SQL execution internal error: Processing aborted due to error 370001:2832376018; incident XXXXXXX.
-- What does TASK_HISTORY have to say about this?
SELECT NAME, STATE, ERROR_CODE, ERROR_MESSAGE FROM TABLE(INFORMATION_SCHEMA.TASK_HISTORY(TASK_NAME=>'TRIGGERED_TASK'));
-- STATE
|ERROR_CODE|ERROR_MESSAGE
|
-- ---------+----------+--------------------------------------------------------+
-- SKIPPED
|0040003
|Conditional expression for task evaluated to false.
|
This is the `EXECUTE` attempt
-- SUCCEEDED|
|
|
This is the `INSERT` attempt
Here I am told the conditional expression for the task (WHEN SYSTEM$STREAM_HAS_DATA('TRIGGER_STREAM')) evaluated to False.
I might have expected EXECUTE to override the condition, but OK.
The page on Troubleshooting Tasks has this for me:
Step 4: Verify the condition
If the task includes a WHEN clause with a
SYSTEM$STREAM_HAS_DATA condition, verify that the specified stream
contained change data capture (CDC) records when the task was last
scheduled to run. Historical data for a stream can be queried using an
AT | BEFORE clause.
I get the idea, there were no new records in the stream, so the condition was not met.
But then, why does SYSTEM$STREAM_HAS_DATA return True when I call it directly?
-- Is the stream hydrated?
SELECT COUNT(*) FROM TRIGGER_STREAM;
-- COUNT(*)|
-- --------+
--
3|
-- OK but records already triggered the Task and are 'old'(?).
-- Does the Task's condition evaluate to True?
SELECT SYSTEM$STREAM_HAS_DATA('TRIGGER_STREAM') AS TASK_CONDITION;
-- TASK_CONDITION|
-- --------------+
-- true
|
Checking the documentation for SYSTEM$STREAM_HAS_DATA(...)
When the input is a view stream, the returned value is TRUE when
change data capture (CDC) records for the underlying tables change.
The function performs a diff on the version metadata for the
underlying tables rather than for the view itself. The result is a
false positive when the query in the source view definition does not
reference the rows in the underlying tables that have changed. The
rate of false positives increases as a view becomes more selective.
When this function is referenced in the optional WHEN parameter in a
task definition, the higher false positive rate means that tasks may
run when a view stream is empty more often than when a table stream is
the input for the function. However, this check still avoids task runs
when there is no change in the underlying table data.
From that I would have expected either to see FALSE returned when I called the function myself, or to
for this to be a 'false positive' that would have allowed the task above to execute.
What am I missing here?
sqlsnowflake-cloud-data-platform
Share
Improve this question
Follow
edited 5 hours ago
Dale K
28.1k1515 gold badges5959 silver badges8585 bronze badges
asked 5 hours ago
MackMMackM
3,01455 gold badges3535 silver badges5050 bronze badges
Add a comment
|
Related questions
4337
How do I UPDATE from a SELECT in SQL Server?
3323
How to add a column with a default value to an existing table in SQL Server?
2769
How can I prevent SQL injection in PHP?
Related questions
4337
How do I UPDATE from a SELECT in SQL Server?
3323
How to add a column with a default value to an existing table in SQL Server?
2769
How can I prevent SQL injection in PHP?
629
UPSERT *not* INSERT or REPLACE
2451
How to concatenate text from multiple rows into a single text string in SQL Server
1986
How to query MongoDB with "like"
2221
How to return only the Date from a SQL Server DateTime datatype
1671
How to reset AUTO_INCREMENT in MySQL
1799
How can I delete using INNER JOIN with SQL Server?
Load 6 more related questions
Show fewer related questions
0
Sorted by:
Reset to default
Highest score (default)
Trending (recent votes count more)
Date modified (newest first)
Date created (oldest first)
Know someone who can answer? Share a link to this question via email, Twitter, or Facebook.
Your Answer
Thanks for contributing an answer to Stack Overflow!Please be sure to answer the question. Provide details and share your research!But avoid …Asking for help, clarification, or responding to other answers.Making statements based on opinion; back them up with references or personal experience.To learn more, see our tips on writing great answers.
Draft saved
Draft discarded
Sign up or log in
Sign up using Google
Sign up using Email and Password
Submit
Post as a guest
Name
Email
Required, but never shown
Post as a guest
Name
Email
Required, but never shown
Post Your Answer
Discard
By clicking “Post Your Answer”, you agree to our terms of service and acknowledge you have read our privacy policy.
Start asking to get answers
Find the answer to your question by asking.
Ask question
Explore related questions
sqlsnowflake-cloud-data-platform
See similar questions with these tags.
The Overflow Blog
Democratizing your data access with AI agents
The history and future of software development (part 1)
Featured on Meta
Spevacus has joined us as a Community Manager
Introducing a new proactive anti-spam measure
New and improved coding challenges
New comment UI experiment graduation
Policy: Generative AI (e.g., ChatGPT) is banned
Hot Network Questions
How to crack ECC using halving
What is the exact meaning of olcAccess: {1}to dn.exact="" by * read
Woman from bubble city where all men are infertile meets fertile man from another city
How do I make the middle of the bill curve up?
Separating trefoil knot on torus
What license to use when extending a pre-existing library?
How to draw the following graph in latex?
Best solution to prevent loop between tables for granular relations
Where was the Kenya sequence in The Crown Episode 1 filmed?
What does it mean for work to be done ON a system?
3 variables cyclic rearrangement inequality.
What's the cents value of these SMuFL accidentals?
What "real mistakes" exist in the Messier catalog?
Does pseudo-vitae revenants produce replenish vitae in Kindred?
How does a telepathic bond work if the bondee lacks language?
Does the Arostotelian species-genus concept apply to non-living things?
How can blood fuel space travel?
What is the effectiveness of using a miniature (ground) plane to route vias through as opposed to using separate paths and vias?
Smoothing a triangulated surface without changing its quasi-isometry class
Can a state execute an ICC arrest warrant in international waters?
how would you formalise in first order logic the sentence "I am a liar"?
What does it mean for a museum exhibit "not to have a Soviet anniversary"?
How do trees drop their leaves?
Could our telescopes detect a type I civilisation
more hot questions
Question feed
Subscribe to RSS
Question feed
To subscribe to this RSS feed, copy and paste this URL into your RSS reader.
lang-sql
Stack Overflow
Questions
Help
Chat
Products
Teams
Advertising
Talent
Company
About
Press
Work Here
Legal
Privacy Policy
Terms of Service
Contact Us
Your Privacy Choices
Cookie Policy
Stack Exchange Network
Technology
Culture & recreation
Life & arts
Science
Professional
Business
API
Data
Blog
Facebook
Twitter
LinkedIn
Instagram
Site design / logo © 2025 Stack Exchange Inc;
user contributions licensed under
CC BY-SA
.
rev 2025.9.25.34480