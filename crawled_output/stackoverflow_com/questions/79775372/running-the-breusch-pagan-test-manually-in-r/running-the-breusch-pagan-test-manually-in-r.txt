regression - Running the Breusch-Pagan test manually in R - Cross Validated
Skip to main content
Stack Exchange Network
Stack Exchange network consists of 183 Q&A communities including Stack Overflow, the largest, most trusted online community for developers to learn, share their knowledge, and build their careers.
Visit Stack Exchange
Loading…
Tour
Start here for a quick overview of the site
Help Center
Detailed answers to any questions you might have
Meta
Discuss the workings and policies of this site
About Us
Learn more about Stack Overflow the company, and our products
current community
Cross Validated
help
chat
Cross Validated Meta
your communities
Sign up or log in to customize your list.
more stack exchange communities
company blog
Log in
Sign up
Home
Questions
Unanswered
AI Assist
Labs
Tags
Chat
Users
Teams
Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
Try Teams for free
Explore Teams
Teams
Ask questions, find answers and collaborate at work with Stack Overflow for Teams.
Explore Teams
Teams
Q&A for work
Connect and share knowledge within a single location that is structured and easy to search.
Learn more about Teams
Running the Breusch-Pagan test manually in R
Ask Question
Asked
today
Modified
today
Viewed
2 times
1
$\begingroup$
This question was migrated from Stack Overflow because it can be answered on Cross Validated.
Migrated 25 mins ago.
I am trying to run the Breusch-Pagan test manually in RStudio from a weighted linear model (wi = 1/x2). I need help verifying whether the following rationale is correct:
What I did:
WLS and residuals
# fit m1
m1 <- lm(y~x, data=dt, weights = 1/x^2)
# internally standardized residuals
stdwres_m1 <- rstandard(m1)
# externally standardized residuals (studentized)
studres_m1 <- studres(m1)
My question starts here. Will the residuals obtained as shown above correspond to the residuals of the weighted model (m1)? Which of these residuals should I use to proceed with statistical tests? Can I use the studentized residuals? Does it make a difference? My confusion arises at this point because of the possibility of computing the weighted residuals (using "weighted.residuals()") of the lm() object.
In the context of performing the Breusch-Pagan test manually using studentized residuals:
# auxiliary regression
# getting the squared studentized residuals
squared_studres1 <- studres_m1^2
# structuring the auxiliary regression
auxregm1 <- lm(squared_studres1~x, dt)
n <- nobs(auxregm1)
rsquared_auxm1 <- summary(auxregm1)$r.squared
# running the test statistic
bpstatm1 <- n*rsquared_auxm1
bpstatm1
# p-value
df_auxm1 <- length(coef(auxregm1))-1
pvaluem1 <- 1-pchisq(bpstatm1, df=df_auxm1)
pvaluem1
Is the above correct?
Does the result of the above not correspond to the result obtained by running "bptest(m1)" directly because each approach assumes different residuals?
Any help will be greatly appreciated.
rregressionweightedhypothesis-testing
Share
Cite
Improve this question
Follow
asked 5 hours ago
finattisakafinattisaka
1122 bronze badges
$\endgroup$
0
Add a comment
|
0
Sorted by:
Reset to default
Highest score (default)
Date modified (newest first)
Date created (oldest first)
Know someone who can answer? Share a link to this question via email, Twitter, or Facebook.
Your Answer
Thanks for contributing an answer to Cross Validated!Please be sure to answer the question. Provide details and share your research!But avoid …Asking for help, clarification, or responding to other answers.Making statements based on opinion; back them up with references or personal experience.Use MathJax to format equations. MathJax reference.To learn more, see our tips on writing great answers.
Draft saved
Draft discarded
Sign up or log in
Sign up using Google
Sign up using Email and Password
Submit
Post as a guest
Name
Email
Required, but never shown
Post as a guest
Name
Email
Required, but never shown
Post Your Answer
Discard
By clicking “Post Your Answer”, you agree to our terms of service and acknowledge you have read our privacy policy.
Start asking to get answers
Find the answer to your question by asking.
Ask question
Explore related questions
rregressionweightedhypothesis-testing
See similar questions with these tags.
Featured on Meta
Introducing a new proactive anti-spam measure
Spevacus has joined us as a Community Manager
stackoverflow.ai - rebuilt for attribution
Community Asks Sprint Announcement - September 2025
Related
9
Testing homoscedasticity with Breusch-Pagan test
1
Breusch-Pagan test
0
Interpretation of the Breusch-Pagan bptest () test in R
4
Disagreement between studentized Breusch-Pagan test and the plots "residuals vs fitted" and "scale location"
4
Breusch Pagan test in Python
1
Conflicting Results Between Residuals Plot and Breusch-Pagan Test
Hot Network Questions
What does it mean for work to be done ON a system?
How to design a circuit that outputs the binary position of the 3rd set bit from the right in an 8-bit input?
I'm having a hard time intuiting throttle position to engine rpm consistency between gears -- why do cars behave in this observed way?
Ian Stewart, Definition for Primitive Root of Unity
Stretch an elastic band around three nails so that it relaxes when any nail is removed
How to use ≥ 16 usbip ports from one host controller on Debian?
How can an alien symbiote coexist with the immune system long-term?
What is the exact meaning of olcAccess: {1}to dn.exact="" by * read
Does clipping distortion affect the information contained within a frequency-modulated signal?
What license to use when extending a pre-existing library?
Find non-trivial improvement after submitting
Lock icon to convey disabled but has a clickable feature?
Are there any problems with mastering my own music?
Changing size of math environments
Verify a Chinese ID Number
What does "my left a** cheek" mean?
Traveling by car on train in Germany
Are there any alternatives to electricity that work/behave in a similar way?
What is this glass device I found next to drinking glasses in the south of France
Where was the Kenya sequence in The Crown Episode 1 filmed?
rkhunter Updates -- "no updates" for several months now
Do academics mind if someone outside their field critiques their work?
How to convert square wave to sine wave
failed to resolve source metadata for docker.io/library/openjdk:21-slim-buster
more hot questions
Question feed
Subscribe to RSS
Question feed
To subscribe to this RSS feed, copy and paste this URL into your RSS reader.
lang-r
Cross Validated
Tour
Help
Chat
Contact
Feedback
Company
Stack Overflow
Teams
Advertising
Talent
About
Press
Legal
Privacy Policy
Terms of Service
Your Privacy Choices
Cookie Policy
Stack Exchange Network
Technology
Culture & recreation
Life & arts
Science
Professional
Business
API
Data
Blog
Facebook
Twitter
LinkedIn
Instagram
Site design / logo © 2025 Stack Exchange Inc;
user contributions licensed under
CC BY-SA
.
rev 2025.9.25.34480